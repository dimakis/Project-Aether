# =============================================================================
# Project Aether Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# NEVER commit .env to version control.

# -----------------------------------------------------------------------------
# Home Assistant (Optional — can be configured via the UI setup wizard)
# -----------------------------------------------------------------------------
# These are optional if you use the first-time setup wizard in the UI.
# The wizard stores HA URL and token in the database (encrypted with Fernet).
# Env vars serve as fallback / recovery.
HA_URL=http://homeassistant.local:8123
HA_TOKEN=your_long_lived_access_token_here
# Optional: remote URL for fallback when local is unreachable
# HA_URL_REMOTE=https://your-instance.ui.nabu.casa

# -----------------------------------------------------------------------------
# LLM Provider (Required for agents)
# -----------------------------------------------------------------------------
# Supports: openai, openrouter, google, ollama, together, groq, custom
LLM_PROVIDER=openai
LLM_API_KEY=sk-your-api-key-here
LLM_MODEL=gpt-4o
# LLM_TEMPERATURE=0.7

# Uncomment for OpenRouter (100+ models):
# LLM_PROVIDER=openrouter
# LLM_API_KEY=sk-or-v1-your-key
# LLM_MODEL=anthropic/claude-sonnet-4

# Uncomment for Google Gemini:
# LLM_PROVIDER=google
# GOOGLE_API_KEY=your-google-key
# LLM_MODEL=gemini-2.0-flash

# Uncomment for local Ollama (free, no API key):
# LLM_PROVIDER=ollama
# LLM_MODEL=mistral:latest

# Custom OpenAI-compatible endpoint:
# LLM_BASE_URL=https://api.together.xyz/v1

# Per-agent model overrides (optional — saves cost on script generation)
# Resolution: UI model selection > per-agent setting > global default
# DATA_SCIENTIST_MODEL=gpt-4o-mini
# DATA_SCIENTIST_TEMPERATURE=0.3

# LLM failover (optional — auto-switches when primary fails after retries)
# LLM_FALLBACK_PROVIDER=openai
# LLM_FALLBACK_MODEL=gpt-4o

# -----------------------------------------------------------------------------
# Database (Required)
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql+asyncpg://aether:aether@localhost:5432/aether
# DATABASE_POOL_SIZE=5
# DATABASE_MAX_OVERFLOW=10
# DATABASE_POOL_TIMEOUT=30

# Sync URL for Alembic migrations (asyncpg → psycopg2 equivalent)
DATABASE_URL_SYNC=postgresql://aether:aether@localhost:5432/aether

# -----------------------------------------------------------------------------
# MLflow (Constitution: Principle III — Observability)
# -----------------------------------------------------------------------------
MLFLOW_TRACKING_URI=http://localhost:5002
MLFLOW_EXPERIMENT_NAME=aether

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
ENVIRONMENT=development
LOG_LEVEL=INFO
DEBUG=false
API_HOST=0.0.0.0
API_PORT=8000
# API_WORKERS=1

# Public URL for this Aether instance (used to generate webhook URLs that HA can reach).
# Set this if HA is remote or you're behind a reverse proxy / NAT.
# Example: https://aether.example.com
# PUBLIC_URL=

# -----------------------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------------------
# API key for programmatic access (empty = disabled)
API_KEY=

# Session authentication (JWT + Passkey)
AUTH_USERNAME=admin
# Password for login (optional — can be set during setup wizard instead)
# The wizard stores a bcrypt hash in the DB. This env var is a fallback.
AUTH_PASSWORD=
# JWT signing secret (auto-generated if empty; set for multi-worker stability)
# Also used to derive the Fernet key for encrypting the HA token in the DB.
JWT_SECRET=
JWT_EXPIRY_HOURS=72

# WebAuthn / Passkey (Face ID / Touch ID login)
# Set these to match your domain when using remote access
WEBAUTHN_RP_ID=localhost
WEBAUTHN_RP_NAME=Aether
WEBAUTHN_ORIGIN=http://localhost:3000

# Google OAuth 2.0 (optional — empty = disabled)
# GOOGLE_CLIENT_ID=
# GOOGLE_CLIENT_SECRET=

# CORS (comma-separated origins, empty = auto based on ENVIRONMENT)
ALLOWED_ORIGINS=

# -----------------------------------------------------------------------------
# Sandbox (Constitution: Principle II — Isolation)
# -----------------------------------------------------------------------------
# SANDBOX_ENABLED=true
# SANDBOX_TIMEOUT_SECONDS=30

# -----------------------------------------------------------------------------
# Scheduler (Scheduled & Event-Driven Insights)
# -----------------------------------------------------------------------------
# SCHEDULER_ENABLED=true
# SCHEDULER_TIMEZONE=UTC
# WEBHOOK_SECRET=

# -----------------------------------------------------------------------------
# Discovery Sync
# -----------------------------------------------------------------------------
# DISCOVERY_SYNC_ENABLED=true
# DISCOVERY_SYNC_INTERVAL_MINUTES=30

# -----------------------------------------------------------------------------
# Timeouts
# -----------------------------------------------------------------------------
# TOOL_TIMEOUT_SECONDS=30
# ANALYSIS_TOOL_TIMEOUT_SECONDS=180

# -----------------------------------------------------------------------------
# Kubernetes Deployment (production only)
# -----------------------------------------------------------------------------
# Process role: "all" (default), "api" (no scheduler), "scheduler" (scheduler only)
# AETHER_ROLE=all

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
ENABLE_TRACING=true
ENABLE_ENTITY_SYNC=true
